# 코드 리뷰

체계적인 코드 리뷰를 수행하는 방법입니다.

## 시나리오

PR의 변경사항을 리뷰합니다.

## 워크플로우

### Step 1: 변경사항 분석

```bash
이 PR의 변경사항을 리뷰해줘
```

### Step 2: 상세 리뷰 (커스텀 스킬 사용)

```bash
skill: code-reviewer 사용해서 리뷰해줘
```

## 리뷰 출력 예시

```markdown
## 코드 리뷰 결과

### ✅ 좋은 점
- 함수 분리가 잘 되어 있음
- 타입 정의가 명확함
- 에러 처리가 적절함

### ⚠️ 개선 필요

#### 1. N+1 쿼리 가능성
- **파일**: `src/api/users.ts`
- **라인**: 42-48
- **문제**: 루프 내에서 개별 쿼리 실행
- **제안**: `Promise.all` 또는 배치 쿼리 사용

#### 2. 에러 메시지 노출
- **파일**: `src/utils/auth.ts`
- **라인**: 15
- **문제**: 내부 에러 메시지가 사용자에게 노출될 수 있음
- **제안**: 사용자용 에러 메시지 분리

### 🚨 반드시 수정

#### 1. 보안 취약점
- **파일**: `src/config.ts`
- **라인**: 8
- **문제**: API 키가 하드코딩됨
- **제안**: 환경 변수로 이동 필수

### 💡 제안
- 테스트 커버리지 추가 권장 (현재 65% → 80% 목표)
- README 업데이트 필요
```

## 커스텀 리뷰 스킬 만들기

```markdown
---
name: code-reviewer
description: "코드 리뷰 전문가. 트리거: 'review', '리뷰', 'PR'."
allowed-tools: Read Grep Glob
---

# 코드 리뷰어

## 리뷰 체크리스트

### 1. 코드 품질
- [ ] 함수가 단일 책임을 가지는가?
- [ ] 변수명이 명확한가?
- [ ] 중복 코드가 없는가?

### 2. 보안
- [ ] SQL 인젝션 취약점 없는가?
- [ ] XSS 취약점 없는가?
- [ ] 민감 정보 노출 없는가?

### 3. 성능
- [ ] N+1 쿼리 문제 없는가?
- [ ] 불필요한 리렌더링 없는가?

### 4. 테스트
- [ ] 테스트 커버리지 충분한가?
- [ ] 엣지 케이스 테스트 있는가?
```

## 리뷰 자동화

### 커스텀 명령어로 PR 리뷰

```markdown
---
description: PR 코드 리뷰
argument-hint: [pr-number]
---

<command-instruction>
# PR 리뷰

## Step 1: 변경 파일 확인
gh pr diff로 변경사항 확인

## Step 2: 체크리스트 기반 리뷰
- 코드 품질
- 보안
- 성능
- 테스트

## Step 3: 리뷰 코멘트 작성
구체적인 라인 번호와 함께 피드백 제공
</command-instruction>

<current-context>
<changed-files>
!`gh pr diff --name-only`
</changed-files>
</current-context>
```

**사용**:
```bash
/review-pr 123
```
