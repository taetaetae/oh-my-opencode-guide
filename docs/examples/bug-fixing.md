# 버그 수정

분석 모드와 Oracle을 활용하여 버그를 추적하고 수정하는 방법입니다.

## 시나리오

"로그인 후 리다이렉트가 작동하지 않음" 버그를 수정합니다.

## 워크플로우

### Step 1: 버그 분석

```bash
analyze 로그인 후 리다이렉트가 작동하지 않는 버그를 분석해줘
```

**실행 과정**:
```
1. Explore 에이전트가 인증 관련 코드 탐색
   ├── src/auth/ 폴더 분석
   ├── 로그인 핸들러 확인
   └── 리다이렉트 로직 확인

2. 잠재적 원인 식별
   ├── 콜백 URL 처리 문제
   ├── 세션 저장 타이밍 문제
   └── 클라이언트/서버 불일치
```

### Step 2: Oracle 상담 (복잡한 경우)

```bash
Oracle에게 물어봐: 이 인증 흐름에서 리다이렉트 문제의 원인이 뭘까?
```

**Oracle 분석**:
```
분석 결과:

1. 근본 원인
   - NextAuth.js의 callbackUrl이 제대로 전달되지 않음
   - 서버 컴포넌트에서 클라이언트 리다이렉트 시도

2. 해결 방안
   - signIn() 호출 시 callbackUrl 명시적 전달
   - useRouter 대신 redirect() 사용
   - 미들웨어에서 리다이렉트 처리

3. 권장 수정 사항
   [구체적인 코드 수정 제안]
```

### Step 3: 수정 적용

```bash
ulw 분석 결과를 바탕으로 버그를 수정해줘
```

**실행 과정**:
```
1. 코드 수정
   ├── src/auth/login.ts 수정
   ├── middleware.ts 수정
   └── 관련 컴포넌트 수정

2. 테스트 추가
   └── src/auth/__tests__/redirect.test.ts 생성

3. 검증
   ├── 기존 테스트 통과 확인
   └── 새 테스트 통과 확인
```

## 디버깅 팁

::: tip 효과적인 디버깅
1. `analyze` 키워드로 분석 모드 활성화
2. 복잡한 버그는 Oracle에게 상담
3. 수정 후 반드시 테스트 추가
4. 관련 코드 전체를 검토
:::

::: warning 주의사항
- 증상만 수정하지 말고 근본 원인을 찾으세요
- Oracle의 제안을 맹신하지 말고 검증하세요
- 수정 전 Git 커밋을 해두세요
:::

## 일반적인 버그 유형별 접근법

| 버그 유형 | 접근법 |
|-----------|--------|
| 타입 에러 | LSP 진단 확인 |
| 런타임 에러 | 로그 분석 + Oracle |
| 로직 에러 | 단계별 디버깅 |
| 성능 문제 | 프로파일링 + Oracle |
| 보안 취약점 | Oracle 상담 필수 |
